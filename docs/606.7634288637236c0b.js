"use strict";(self.webpackChunkgamestudio_refactor=self.webpackChunkgamestudio_refactor||[]).push([[606],{606:(z,p,c)=>{c.r(p),c.d(p,{MinesweeperModule:()=>S});var h=c(782),e=c(256),m=c(579);let g=(()=>{class n{constructor(){this.timer$=new m.x,this.intervalId=null,this.startTime=0}startTimer(){this.startTime=Date.now(),this.intervalId=setInterval(()=>{const t=Date.now()-this.startTime;this.updateTimer(t)},10)}pauseTimer(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}getTimer(){return this.timer$.asObservable()}resetTimer(){this.pauseTimer(),this.startTime=0,this.updateTimer(0)}updateTimer(t){let i=Math.floor(t/6e4).toString().padStart(2,"0"),s=Math.floor(t%6e4/1e3).toString().padStart(2,"0"),o=(t%1e3).toString().padStart(3,"0");this.timer$.next({display:`${i}m:${s}s.${o}ms`,milliseconds:t})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var u=c(895);function f(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.value)}}function _(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u{1f6a9}"),e.qZA())}let b=(()=>{class n{constructor(){this.value="0",this.status="hidden",this.class="tile"}setValue(t){this.value=t}getStyle(){if("visible"===this.status)switch(this.value){case"0":return"tile tile-0";case"1":return"tile tile-1";case"2":return"tile tile-2";case"3":return"tile tile-3";case"4":return"tile tile-4";case"5":return"tile tile-5";case"6":return"tile tile-6";case"7":return"tile tile-7";case"8":return"tile tile-8";case"\u{1f4a3}":return"tile tile-mine";default:return"tile"}else{if("flagged"===this.status)return"tile tile-flag";if("hidden"===this.status)return"tile tile-hidden"}return"tile"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-minesweeper-tile"]],inputs:{value:"value",status:"status"},decls:3,vars:3,consts:[[1,"tile",3,"ngClass"],[4,"ngIf"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,f,2,1,"span",1),e.YNc(2,_,2,0,"span",1),e.qZA()),2&t&&(e.Q6J("ngClass",i.getStyle()),e.xp6(1),e.Q6J("ngIf","visible"===i.status),e.xp6(1),e.Q6J("ngIf","flagged"===i.status))},dependencies:[u.mk,u.O5],styles:[".tile[_ngcontent-%COMP%]{position:relative;width:30px;height:30px;border:2px solid rgba(255,255,255,.5);border-bottom:4px solid #3d3d3d;border-left:3px solid rgba(137,47,92,.5);border-radius:8px;background-color:#727272;box-shadow:5px 5px 3px 4px #0000006f;display:grid;place-items:center;transition:80ms;margin:1px;color:#fff;font-weight:700;-webkit-user-select:none;user-select:none;z-index:2}.tile-hidden[_ngcontent-%COMP%]:hover{filter:brightness(2);transform:scale(1.15);cursor:pointer}.tile-0[_ngcontent-%COMP%]{color:#434242;background-color:#262626;border:none;box-shadow:none;z-index:0;opacity:.5}.tile-hidden[_ngcontent-%COMP%]{box-shadow:none}.tile-1[_ngcontent-%COMP%]{background-color:#6665cf}.tile-2[_ngcontent-%COMP%]{background-color:#42ab3e}.tile-3[_ngcontent-%COMP%]{background-color:#ff3c00}.tile-4[_ngcontent-%COMP%]{background-color:#234cac}.tile-5[_ngcontent-%COMP%]{background-color:#d24646}.tile-6[_ngcontent-%COMP%]{background-color:#b960f9}.tile-7[_ngcontent-%COMP%]{background-color:#cdcdcd}.tile-8[_ngcontent-%COMP%]{background-color:#6a6a6a}.tile-flag[_ngcontent-%COMP%]{background-color:orange}.tile-mine[_ngcontent-%COMP%]{background-color:#b01717;transform:scale(1.4)}@media screen and (max-width: 550px){.tile[_ngcontent-%COMP%]{width:25px;height:25px}}"]}),n})();function v(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"app-minesweeper-tile",15),e.NdJ("click",function(){const o=e.CHM(t).index,l=e.oxw().index,a=e.oxw();return e.KtG(a.openTile(l,o))})("contextmenu",function(s){const l=e.CHM(t).index,a=e.oxw().index,d=e.oxw();return e.KtG(d.placeFlag(s,a,l))}),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t.value)("status",t.status)}}function C(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,v,2,2,"div",11),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function T(n,r){1&n&&(e.TgZ(0,"div",16),e._uU(1,"YOU lOST"),e.qZA())}function w(n,r){if(1&n&&(e.TgZ(0,"div",17),e._uU(1,"YOU WON "),e.TgZ(2,"p"),e._uU(3,"score:"),e.qZA(),e.TgZ(4,"h3"),e._uU(5),e.qZA()()),2&n){const t=e.oxw();e.xp6(5),e.Oqu(t.score)}}function x(n,r){1&n&&(e.TgZ(0,"div",18),e._uU(1,"Resetting"),e.qZA())}const M=function(n){return{"grid-template-columns":n}},Z=[{path:"",component:(()=>{class n{constructor(t){this.timerService=t,this.size=10,this.mineCount=8,this.board=[],this.sizeControl=this.size,this.mineControl=this.mineCount,this.status="paused",this.timerData={display:"00m:00s.000ms",milliseconds:0},this.score=0,this.scoreSubmitted=!1}ngOnInit(){this.initBoard()}changeSize(t){this.sizeControl+t>4&&this.sizeControl+t<=17&&(this.sizeControl+=t);let i=this.sizeControl*this.sizeControl-1;this.mineControl>i&&(this.mineControl=i)}changeMineCount(t){this.mineControl+t>=2&&this.mineControl+t<=this.sizeControl*this.sizeControl-1&&(this.mineControl+=t)}setNewBoard(){this.size=this.sizeControl,this.mineCount=this.mineControl,this.resetGame()}initBoard(){this.generateBoard(),this.generateMines(),this.generateClues()}setTime(t){this.timerData.display=t}startTime(){this.timerService.startTimer()}pauseTime(){this.timerService.pauseTimer()}resetTime(){this.timerService.resetTimer()}setScore(){this.score=(this.size+this.size)*this.mineCount-Math.floor(this.timerData.milliseconds/1e3)}showScore(){this.setScore(),console.log(this.score)}resetGame(){this.board=[],this.status="reset",this.resetTime(),setTimeout(()=>{this.status="paused"},500),this.scoreSubmitted=!1,this.initBoard()}startGame(){this.status="playing",this.startTime(),this.timeSubscription=this.timerService.getTimer().subscribe(t=>{this.timerData=t})}openTile(t,i){"paused"===this.status&&this.startGame();const s=this.board[t][i];"flagged"!==s.status&&(s.status="visible","0"===s.value&&this.openAdjacentTiles(t,i),"\u{1f4a3}"===s.value?(this.status="lost",this.pauseTime(),this.revealMines()):this.isSolved()&&(this.status="won",this.setScore(),this.pauseTime(),this.markAllMines(),this.scoreSubmitted||this.submitScore()))}ngOnDestroy(){this.timeSubscription&&this.timeSubscription.unsubscribe()}submitScore(){this.scoreSubmitted=!0}placeFlag(t,i,s){t.preventDefault();const o=this.board[i][s];"hidden"===o.status?this.countTilesByStatus("flagged")<this.mineCount&&(o.status="flagged"):"flagged"===o.status&&(o.status="hidden")}isSolved(){return this.size*this.size-this.countTilesByStatus("visible")===this.mineCount}countTilesByStatus(t){let i=0;for(let s=0;s<this.size;s++)for(let o=0;o<this.size;o++)this.board[s][o].status===t&&i++;return i}generateBoard(){for(let t=0;t<this.size;t++){this.board.push([]);for(let i=0;i<this.size;i++)this.board[t].push({value:"0",status:"hidden"})}}generateMines(){let t=0;for(;t<this.mineCount;){let i=Math.floor(Math.random()*this.size),s=Math.floor(Math.random()*this.size);"\u{1f4a3}"!==this.board[i][s].value&&(this.board[i][s].value="\u{1f4a3}",t++)}}generateClues(){for(let t=0;t<this.size;t++)for(let i=0;i<this.size;i++)"\u{1f4a3}"!==this.board[t][i].value&&(this.board[t][i].value=`${this.countAdjacentMines(t,i)}`)}countAdjacentMines(t,i){let s=0;for(let o=-1;o<=1;o++){let l=t+o;if(l>=0&&l<this.size)for(let a=-1;a<=1;a++){let d=i+a;d>=0&&d<this.size&&"\u{1f4a3}"===this.board[l][d].value&&s++}}return s}revealMines(){for(let t=0;t<this.size;t++)for(let i=0;i<this.size;i++)"\u{1f4a3}"===this.board[t][i].value&&(this.board[t][i].status="visible")}markAllMines(){for(let t=0;t<this.size;t++)for(let i=0;i<this.size;i++)"\u{1f4a3}"===this.board[t][i].value&&(this.board[t][i].status="flagged")}openAdjacentTiles(t,i){for(let s=-1;s<=1;s++){let o=t+s;if(o>=0&&o<this.size)for(let l=-1;l<=1;l++){let a=i+l;a>=0&&a<this.size&&"hidden"===this.board[o][a].status&&this.openTile(o,a)}}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(g))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-minesweeper"]],decls:47,vars:14,consts:[[1,"main-wrapper"],[1,"box","box-title"],[1,"box"],[1,"box-item"],[1,"box-text"],[1,"box-numb"],[1,"btn-field",3,"click"],[1,"status-item"],[1,"timer"],[3,"click"],[1,"board",3,"ngStyle"],[4,"ngFor","ngForOf"],["class","overlay lose-screen",4,"ngIf"],["class","overlay win-screen",4,"ngIf"],["class","overlay reset-screen",4,"ngIf"],[3,"value","status","click","contextmenu"],[1,"overlay","lose-screen"],[1,"overlay","win-screen"],[1,"overlay","reset-screen"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2"),e._uU(3,"Minesweeper"),e.qZA()(),e.TgZ(4,"div",2)(5,"div",3)(6,"span",4),e._uU(7,"Size: "),e.qZA(),e.TgZ(8,"span",5),e._uU(9),e.qZA(),e.TgZ(10,"button",6),e.NdJ("click",function(){return i.changeSize(-1)}),e._uU(11,"-"),e.qZA(),e.TgZ(12,"button",6),e.NdJ("click",function(){return i.changeSize(1)}),e._uU(13,"+"),e.qZA()(),e.TgZ(14,"div",3)(15,"span",4),e._uU(16,"Mines: "),e.qZA(),e.TgZ(17,"span",5),e._uU(18),e.qZA(),e.TgZ(19,"button",6),e.NdJ("click",function(){return i.changeMineCount(-1)}),e._uU(20,"-"),e.qZA(),e.TgZ(21,"button",6),e.NdJ("click",function(){return i.changeMineCount(1)}),e._uU(22,"+"),e.qZA()(),e.TgZ(23,"button",6),e.NdJ("click",function(){return i.setNewBoard()}),e._uU(24,"set"),e.qZA()(),e.TgZ(25,"div",2)(26,"div",7)(27,"span",4),e._uU(28,"\u2705Status: "),e.qZA(),e.TgZ(29,"span",5),e._uU(30),e.qZA()(),e.TgZ(31,"div",8)(32,"button",9),e.NdJ("click",function(){return i.showScore()}),e._uU(33,"score"),e.qZA(),e._uU(34),e.qZA(),e.TgZ(35,"div",7)(36,"span",4),e._uU(37,"\u{1f6a9}Flags: "),e.qZA(),e.TgZ(38,"span",5),e._uU(39),e.qZA()()(),e.TgZ(40,"div",10),e.YNc(41,C,2,1,"div",11),e.YNc(42,T,2,0,"div",12),e.YNc(43,w,6,1,"div",13),e.YNc(44,x,2,0,"div",14),e.qZA(),e.TgZ(45,"button",6),e.NdJ("click",function(){return i.resetGame()}),e._uU(46," reset"),e.qZA()()),2&t&&(e.xp6(9),e.Oqu(i.sizeControl),e.xp6(9),e.Oqu(i.mineControl),e.xp6(12),e.AsE(" ",i.countTilesByStatus("visible")," / ",i.size*i.size-i.mineCount," "),e.xp6(4),e.hij(" ",i.timerData.display," "),e.xp6(5),e.AsE(" ",i.countTilesByStatus("flagged")," / ",i.mineCount," "),e.xp6(1),e.Q6J("ngStyle",e.VKq(12,M,"repeat("+i.size+", 1fr)")),e.xp6(1),e.Q6J("ngForOf",i.board),e.xp6(1),e.Q6J("ngIf","lost"===i.status),e.xp6(1),e.Q6J("ngIf","won"===i.status),e.xp6(1),e.Q6J("ngIf","reset"===i.status))},dependencies:[u.sg,u.O5,u.PC,b],styles:[".box[_ngcontent-%COMP%]{display:grid;grid-auto-flow:column;align-items:center;grid-gap:30px;padding:15px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background-color:#141414;box-shadow:0 0 5px 3px #191919;border:1px solid rgb(49,49,49);color:#ee8f00;border-radius:6px;-webkit-user-select:none;user-select:none;margin:auto;min-width:520px;justify-content:space-between}.box-title[_ngcontent-%COMP%]{text-align:center;justify-content:center}.box-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 25px 23px 23px;gap:4px;align-items:center}.box-row[_ngcontent-%COMP%]{display:grid;grid-auto-flow:column;justify-content:center;gap:4px}.box-numb[_ngcontent-%COMP%]{text-align:right;color:#fff;background-color:#282727;border:1px solid rgb(86,56,22);border-radius:4px;padding:2px}.status-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 80px;gap:4px;align-items:center}.btn-field[_ngcontent-%COMP%]{background-color:#303030;border:1px solid rgb(96,96,96);border-radius:4px;padding:4px;min-width:25px;width:-moz-fit-content;width:fit-content;color:#ee8f00;transition:90ms;-webkit-user-select:none;user-select:none}.btn-field[_ngcontent-%COMP%]:hover{filter:brightness(1.2);transform:scale(1.2);cursor:pointer}.btn-pressed[_ngcontent-%COMP%]{filter:brightness(1.2);transform:scale(1.2)}@media (max-width: 728px){.box[_ngcontent-%COMP%]{grid-auto-flow:row;justify-content:center;gap:10px;justify-self:stretch;min-width:auto;width:90%}}.board[_ngcontent-%COMP%]{position:relative;display:grid;width:-moz-fit-content;width:fit-content;box-shadow:0 0 8px 3px #191919;border-radius:4px;overflow:hidden}"]}),n})()}];let S=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.Bz.forChild(Z),h.Bz]}),n})()}}]);